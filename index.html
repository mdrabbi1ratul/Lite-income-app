<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lite Income Admin - Referral Pro</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        /* ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡¶ø‡¶ú‡¶ø‡¶®‡¶æ‡¶≤ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® - ‡¶è‡¶ï‡¶¶‡¶Æ ‡¶Ü‡¶®‡¶ü‡¶æ‡¶ö‡¶° */
        :root { --primary: #00d2ff; --bg: #0a0b10; --sidebar-bg: #0d1117; --card: #161b22; --text: #e6edf3; --danger: #ff4b2b; --success: #00f2fe; --sidebar-width: 280px; }
        body { margin:0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }
        
        #login-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 100000; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .login-card { background: var(--card); padding: 30px; border-radius: 15px; border: 1px solid var(--primary); width: 100%; max-width: 350px; text-align: center; }

        .sidebar { position: fixed; top: 0; left: 0; width: var(--sidebar-width); height: 100%; background: var(--sidebar-bg); padding: 25px; border-right: 1px solid #30363d; display: flex; flex-direction: column; z-index: 10000; transform: translateX(-105%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); box-sizing: border-box; }
        .sidebar.active { transform: translateX(0); }
        .side-link { padding: 14px; cursor: pointer; border-radius: 10px; margin-top: 10px; color: #8b949e; display: flex; align-items: center; gap: 10px; transition: 0.3s; }
        .side-link:hover, .side-link.active { background: rgba(0, 210, 255, 0.1); color: var(--primary); }
        .header-bar { position: fixed; top: 0; left: 0; width: 100%; height: 60px; background: var(--sidebar-bg); display: flex; align-items: center; padding: 0 20px; z-index: 999; border-bottom: 1px solid #30363d; justify-content: space-between; }
        .toggle-btn { background: var(--primary); color: #000; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: none; z-index: 9999; backdrop-filter: blur(4px); }
        .overlay.active { display: block; }
        .main { flex-grow: 1; padding: 80px 20px 40px 20px; overflow-y: auto; width: 100%; }
        .card { background: var(--card); border-radius: 12px; padding: 20px; border: 1px solid #30363d; margin-bottom: 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: #0d1117; padding: 20px; border-radius: 10px; border-top: 3px solid var(--primary); text-align: center; }
        .search-box { width: 100%; padding: 12px; margin-bottom: 15px; background: #0d1117; border: 1px solid var(--primary); color: white; border-radius: 8px; }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; min-width: 700px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #30363d; font-size: 14px; }
        .status-active { color: var(--success); font-weight: bold; }
        .status-banned { color: var(--danger); font-weight: bold; }
        input, textarea, select { width: 100%; padding: 12px; margin: 8px 0; background: #0d1117; border: 1px solid #30363d; color: white; border-radius: 8px; box-sizing: border-box;}
        .btn { padding: 8px 15px; border-radius: 6px; border: none; cursor: pointer; font-weight: bold; background: var(--primary); color: #000; margin-right: 5px; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-success { background: var(--success); color: #000; }
        .section { display: none; }
        .active-section { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-card">
            <h2 style="color: var(--primary);">Admin Login</h2>
            <input type="text" id="adminUser" placeholder="Username">
            <input type="password" id="adminPass" placeholder="Password">
            <button class="btn" style="width: 100%; padding: 12px; margin-top: 10px;" onclick="checkLogin()">Login Now</button>
        </div>
    </div>

    <div id="admin-panel" style="display: none; width: 100%;">
        <div class="header-bar">
            <button class="toggle-btn" onclick="toggleMenu()">‚ò∞ MENU</button>
            <h3 id="topTitle" style="color: var(--primary);">Lite Income Control</h3>
        </div>

        <div class="overlay" id="overlay" onclick="toggleMenu()"></div>

        <div class="sidebar" id="sidebar">
            <h2 style="color:var(--primary); text-align:center;">LITE CONTROL</h2>
            <div class="side-link active" onclick="showSection('dash', this)">üìä ‡¶ì‡¶≠‡¶æ‡¶∞‡¶≠‡¶ø‡¶â</div>
            <div class="side-link" onclick="showSection('users', this)">üë• ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</div>
            <div class="side-link" onclick="showSection('referSection', this)">üéÅ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</div>
            <div class="side-link" onclick="showSection('payments', this)">üí∞ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</div>
            <div class="side-link" onclick="showSection('settings', this)">‚öôÔ∏è ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</div>
            <div class="side-link" style="margin-top: auto; color: var(--danger);" onclick="logout()">üîí ‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü</div>
        </div>

        <div class="main" id="main-ui">
            <div id="dash" class="section active-section">
                <div class="stats-grid">
                    <div class="stat-card"><span>‡¶Æ‡ßã‡¶ü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</span><h3 id="statTotalUsers">0</h3></div>
                    <div class="stat-card"><span>‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶∞‡ßá‡¶´‡¶æ‡¶∞</span><h3 id="statPendingRef">0</h3></div>
                    <div class="stat-card"><span>‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü</span><h3 id="statPendingPay">0</h3></div>
                    <div class="stat-card"><span>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</span><h3 id="statTotalPoints">$0.00</h3></div>
                </div>
            </div>

            <div id="users" class="section">
                <input type="text" class="search-box" id="userSearch" onkeyup="searchUser()" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¶‡¶ø‡ßü‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®...">
                <div class="card table-container">
                    <table>
                        <thead>
                            <tr><th>‡¶á‡¶Æ‡ßá‡¶á‡¶≤</th><th>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</th><th>‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</th><th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr>
                        </thead>
                        <tbody id="userTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="referSection" class="section">
                <h2 style="color:var(--primary)">‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶ï‡ßç‡¶≤‡ßá‡¶á‡¶Æ</h2>
                <div class="card table-container">
                    <table>
                        <thead>
                            <tr><th>‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ (Email)</th><th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ</th><th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th></tr>
                        </thead>
                        <tbody id="referTableBody"></tbody>
                    </table>
                </div>
            </div>

            <div id="payments" class="section">
                <h2 style="color:var(--primary)">‡¶™‡ßá‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü</h2>
                <div class="card table-container">
                    <table>
                        <thead>
                            <tr><th>Email</th><th>Amount</th><th>Method</th><th>Phone</th><th>Action</th></tr>
                        </thead>
                        <tbody id="payTable"></tbody>
                    </table>
                </div>
            </div>

            <div id="settings" class="section">
                <div class="card" style="max-width: 600px;">
                    <h2 style="margin-top: 0; color: var(--primary);">Global App Settings</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div><label>Refer Reward ($)</label><input type="number" id="referReward" step="0.01"></div>
                        <div><label>Daily Bonus ($)</label><input type="number" id="dailyBonus" step="0.01"></div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                        <div><label>Min Withdraw ($)</label><input type="number" id="minWithdraw" step="0.01"></div>
                        <div><label>Ad Limit (Total)</label><input type="number" id="adLimit"></div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                        <div><label>Ad View Reward ($)</label><input type="number" id="adReward" step="0.001" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: 0.005"></div>
                        <div><label>Cooldown (Mins)</label><input type="number" id="cooldownMins"></div>
                    </div>
                    <label style="display:block; margin-top:10px;">App Notice (‡¶π‡ßã‡¶Æ ‡¶™‡ßá‡¶ú‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá)</label>
                    <textarea id="appNotice" rows="3"></textarea>
                    <button class="btn btn-success" style="width:100%; margin-top:20px; padding: 15px;" onclick="saveConfig()">SAVE ALL SETTINGS</button>
                </div>
            </div>
        </div>
    </div>

    <div id="editModal" class="overlay" style="display: none; justify-content: center; align-items: center; z-index: 20000;">
        <div class="card" style="width: 90%; max-width: 400px; background: var(--sidebar-bg);">
            <h3 id="editEmailTitle" style="color:var(--primary)">Edit User</h3>
            <label>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶® ($)</label>
            <input type="number" id="editBalInp" step="0.01" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: 0.50 ‡¶¨‡¶æ -0.50">
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="btn btn-success" style="flex: 1;" onclick="updateUserBalance()">Update</button>
                <button class="btn btn-danger" style="flex: 1;" onclick="closeEditModal()">Close</button>
            </div>
        </div>
    </div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyD_umGq2C78hRinwHGl9SNVFuZzb12iooc",
        databaseURL: "https://lite-income-f6287-default-rtdb.firebaseio.com/",
        projectId: "lite-income-f6287",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentEditingUid = "";
    let globalReferBonus = 0.10;

    function checkLogin() {
        const u = document.getElementById('adminUser').value;
        const p = document.getElementById('adminPass').value;
        if(u === "admin" && p === "12345") {
            sessionStorage.setItem("admin_auth", "true");
            startAdmin();
        } else { alert("‡¶≠‡ßÅ‡¶≤ ‡¶§‡¶•‡ßç‡¶Ø!"); }
    }

    function startAdmin() {
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('admin-panel').style.display = 'block';
        loadAllData();
    }

    if(sessionStorage.getItem("admin_auth") === "true") startAdmin();

    function toggleMenu() {
        document.getElementById('sidebar').classList.toggle('active');
        document.getElementById('overlay').classList.toggle('active');
    }

    function showSection(id, element) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active-section'));
        document.getElementById(id).classList.add('active-section');
        document.querySelectorAll('.side-link').forEach(l => l.classList.remove('active'));
        element.classList.add('active');
        if(window.innerWidth < 1000) toggleMenu();
    }

    function loadAllData() {
        db.ref('users').on('value', snap => {
            let count = 0; let totalBal = 0; let html = "";
            snap.forEach(child => {
                const u = child.val(); count++; totalBal += (u.balance || 0);
                const statusClass = u.status === 'Banned' ? 'status-banned' : 'status-active';
                html += `<tr><td>${u.email}</td><td>$${(u.balance || 0).toFixed(2)}</td><td class="${statusClass}">${u.status || 'Active'}</td><td><button class="btn" onclick="openEditModal('${child.key}', '${u.email}')">Edit</button><button class="btn btn-danger" onclick="toggleBan('${child.key}', '${u.status}')">${u.status === 'Banned' ? 'Unban' : 'Ban'}</button></td></tr>`;
            });
            document.getElementById('statTotalUsers').innerText = count;
            document.getElementById('statTotalPoints').innerText = "$" + totalBal.toFixed(2);
            document.getElementById('userTableBody').innerHTML = html;
        });

        db.ref('refer_claims').on('value', snap => {
            let pending = 0; let html = "";
            snap.forEach(child => {
                const r = child.val();
                if(r.status === "Pending") {
                    pending++;
                    html += `<tr><td>${r.refByEmail}</td><td>${r.date}</td><td><button class="btn btn-success" onclick="approveRefer('${child.key}', '${r.refByUid}')">Approve</button><button class="btn btn-danger" onclick="rejectRefer('${child.key}')">Reject</button></td></tr>`;
                }
            });
            document.getElementById('statPendingRef').innerText = pending;
            document.getElementById('referTableBody').innerHTML = html;
        });

        db.ref('withdraws').on('value', snap => {
            let pending = 0; let html = "";
            snap.forEach(child => {
                const w = child.val();
                if(w.status === "Pending") {
                    pending++;
                    html += `<tr><td>${w.email}</td><td>$${w.amount}</td><td>${w.method}</td><td>${w.number}</td><td><button class="btn btn-success" onclick="approvePay('${child.key}')">Done</button></td></tr>`;
                }
            });
            document.getElementById('statPendingPay').innerText = pending;
            document.getElementById('payTable').innerHTML = html;
        });

        db.ref('app_config').on('value', snap => {
            const c = snap.val();
            if(c) {
                document.getElementById('minWithdraw').value = c.minWithdraw || 1.00;
                document.getElementById('adLimit').value = c.adLimit || 15;
                document.getElementById('adReward').value = c.adReward || 0.005;
                document.getElementById('dailyBonus').value = c.dailyBonus || 0.05;
                document.getElementById('referReward').value = c.referReward || 0.10;
                document.getElementById('cooldownMins').value = c.cooldownMins || 720;
                document.getElementById('appNotice').value = c.notice || "";
                globalReferBonus = parseFloat(c.referReward) || 0.10;
            }
        });
    }

    function saveConfig() {
        const adLimit = parseInt(document.getElementById('adLimit').value) || 0;
        const adReward = parseFloat(document.getElementById('adReward').value) || 0;
        const dailyBonus = parseFloat(document.getElementById('dailyBonus').value) || 0;
        const referReward = parseFloat(document.getElementById('referReward').value) || 0;
        const minWithdraw = parseFloat(document.getElementById('minWithdraw').value) || 0;
        const cooldownMins = parseInt(document.getElementById('cooldownMins').value) || 0;
        const notice = document.getElementById('appNotice').value || "";

        db.ref('app_config').update({
            minWithdraw: minWithdraw,
            adLimit: adLimit,
            adReward: adReward,
            dailyBonus: dailyBonus,
            referReward: referReward,
            cooldownMins: cooldownMins,
            notice: notice
        })
        .then(() => {
            alert("‡¶∏‡¶¨ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        })
        .catch((error) => {
            alert("‡¶è‡¶∞‡¶∞: " + error.message);
        });
    }

    function approveRefer(key, uid) {
        db.ref('users/' + uid + '/balance').transaction(b => (b || 0) + globalReferBonus);
        db.ref('refer_claims/' + key).update({ status: 'Approved' });
    }

    function rejectRefer(key) { db.ref('refer_claims/' + key).remove(); }

    function approvePay(key) { 
        if(confirm("Mark as Paid?")) db.ref('withdraws/' + key).update({ status: "Paid" }); 
    }

    function toggleBan(uid, status) {
        db.ref('users/' + uid).update({ status: status === 'Banned' ? 'Active' : 'Banned' });
    }

    function openEditModal(uid, email) {
        currentEditingUid = uid;
        document.getElementById('editEmailTitle').innerText = email;
        document.getElementById('editModal').style.display = 'flex';
    }
    
    function closeEditModal() { document.getElementById('editModal').style.display = 'none'; }

    function updateUserBalance() {
        const amt = parseFloat(document.getElementById('editBalInp').value);
        if(isNaN(amt)) return;
        db.ref('users/' + currentEditingUid + '/balance').transaction(b => (b || 0) + amt)
        .then(() => { alert("Done!"); closeEditModal(); });
    }

    function searchUser() {
        let input = document.getElementById('userSearch').value.toUpperCase();
        let tr = document.getElementById("userTableBody").getElementsByTagName("tr");
        for (let i = 0; i < tr.length; i++) {
            let td = tr[i].getElementsByTagName("td")[0];
            if (td) {
                let txtValue = td.textContent || td.innerText;
                tr[i].style.display = txtValue.toUpperCase().indexOf(input) > -1 ? "" : "none";
            }
        }
    }

    function logout() { sessionStorage.clear(); location.reload(); }
</script>
</body>
                            </html>
